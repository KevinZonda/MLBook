# 2.6 æ”¯æŒå‘é‡æœº Support Vector Machineã€å¾…å®Œæˆã€‘

![ML](https://img.shields.io/badge/LH-Machine%20Learning-red)

> **ğŸ’¡ æé†’ï¼š** è¿™ä¸€èŠ‚å†…å®¹éå¸¸å¤æ‚ã€‚éœ€è¦ä½ æœ‰è¶³å¤Ÿçš„è€å¿ƒå’Œä¸€å®šçš„æ•°å­¦åŠŸåº•ã€‚ç¬¬ä¸€éé˜…è¯»å¯ä»¥ç•¥è¯»æˆ–è·³è¿‡è¿™ä¸€èŠ‚ã€‚

æ”¯æŒå‘é‡æœºï¼ˆSupport Vector Machine, SVMï¼‰æ˜¯ä¸€ç§äºŒåˆ†ç±»æ¨¡å‹ï¼Œå…¶åŸºæœ¬æ¨¡å‹æ˜¯å®šä¹‰åœ¨ç‰¹å¾ç©ºé—´ä¸Šçš„é—´éš”æœ€å¤§çš„çº¿æ€§åˆ†ç±»å™¨ï¼Œå…¶å­¦ä¹ ç­–ç•¥ä¾¿æ˜¯é—´éš”æœ€å¤§åŒ–ã€‚SVM é€šè¿‡é—´éš”æœ€å¤§åŒ–ï¼Œå¯ä»¥ä½¿å¾—æ¨¡å‹å¯¹å™ªå£°æ›´åŠ é²æ£’ï¼Œä»è€Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚


å’Œé€»è¾‘å›å½’ä¸€æ ·ï¼Œæ”¯æŒå‘é‡æœºæ˜¯ä¸€ä¸ªäºŒåˆ†ç±»æ¨¡å‹ï¼Œä¸”å…¶ä¹Ÿæ˜¯ä¸ªçº¿æ€§æ¨¡å‹ï¼Œå³å…¶åˆ†å‰²è¶…å¹³é¢ä¸º $\mathbf{w}^T\mathbf{x}+b=0$ã€‚æˆ‘ä»¬å¯ä»¥å°†æ•°æ®é›†åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»ä¸ºæ­£ç±»ï¼Œä¸€ç±»ä¸ºè´Ÿç±»ã€‚

> **çº¿æ€§å¯åˆ†**æ˜¯æŒ‡å­˜åœ¨ä¸€ä¸ªï¼ˆè¶…ï¼‰å¹³é¢å¯ä»¥å°†æ•°æ®é›†å®Œå…¨åˆ†å‰²å¼€ï¼Œå³æ­£ç±»åœ¨ï¼ˆè¶…ï¼‰å¹³é¢çš„ä¸€ä¾§ï¼Œè´Ÿç±»åœ¨ï¼ˆè¶…ï¼‰å¹³é¢çš„å¦ä¸€ä¾§ã€‚

åœ¨ä¸‹é¢æˆ‘ä»¬å°†é¦–å…ˆè®¨è®ºçº¿æ€§å¯åˆ†æƒ…å†µä¸‹çš„æ”¯æŒå‘é‡æœºã€‚å†ä»‹ç»çº¿æ€§ä¸å¯åˆ†çš„æƒ…å†µã€‚

## åŸºç¡€æƒ³æ³•

æˆ‘ä»¬è€ƒè™‘åˆ†ç±»ç®—æ³•ï¼Œæˆ‘ä»¬åªæ˜¯å…³æ³¨æ˜¯å¦æ‰€æœ‰çš„æ•°æ®ç‚¹è¢«æ­£ç¡®åˆ†ç±»äº†ï¼Œè€Œå¹¶ä¸åœ¨ä¹åˆ†ç±»çš„è¾¹ç•Œã€‚ä½†æ˜¯æ”¯æŒå‘é‡æœºä¸ä»…ä»…å…³æ³¨åˆ†ç±»æ˜¯å¦æ­£ç¡®ï¼Œè¿˜å…³æ³¨åˆ†ç±»çš„è¾¹ç•Œã€‚æˆ‘ä»¬å¸Œæœ›åˆ†ç±»çš„è¾¹ç•Œå°½å¯èƒ½è¿œç¦»æ•°æ®ç‚¹ï¼Œè¿™æ ·å¯ä»¥ä½¿å¾—æ¨¡å‹å¯¹å™ªå£°æ›´åŠ é²æ£’ï¼Œä»è€Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚

è€Œå› æ­¤ï¼Œæˆ‘ä»¬å®šä¹‰äº†æ–°çš„å‡è¯´ï¼š

$$
\begin{equation}
h(\mathbf{x})=\left\{
\begin{aligned}
+1 \quad&\text{ if }\mathbf{w}^T\mathbf{x}+b>0 \\
-1 \quad&\text{ if }\mathbf{w}^T\mathbf{x}+b<0
\end{aligned}
\right.
\end{equation}
$$

å³ï¼Œå¦‚æœè¿™ä¸ªç‚¹åœ¨è¶…å¹³é¢çš„ä¸Šä¾§ï¼Œæˆ‘ä»¬å°†å…¶åˆ†ç±»ä¸ºæ­£ç±»ï¼Œå¦åˆ™åˆ†ç±»ä¸ºè´Ÿç±»ã€‚


## ç‚¹åˆ°å¹³é¢çš„è·ç¦»

åœ¨ä¸€åˆ‡å¼€å§‹å‰ï¼Œæˆ‘éœ€è¦å…ˆä»‹ç»ä¸€ä¸‹ç‚¹åˆ°ï¼ˆè¶…ï¼‰å¹³é¢ï¼ˆåç®€ç§°å¹³é¢ï¼‰çš„è·ç¦»ã€‚

æˆ‘ä»¬å®šä¹‰å¹³é¢ $H$ ä¸º $\mathbf{w}^T\mathbf{x}+b=0$ã€‚
å¹¶å®šä¹‰ç‚¹ $Q$ $(q_1, q_2, q_3,..., q_N)$ åˆ°å¹³é¢ $H$ çš„è·ç¦½ä¸º $\text{dist}(Q, H)$ã€‚

æˆ‘ä»¬æƒ³è¦çŸ¥é“æ€ä¹ˆè®¡ç®—ç‚¹ $Q$ åˆ°å¹³é¢ $H$ çš„è·ç¦»ã€‚

å–å¹³é¢ä»»æ„ä¸€ç‚¹ $P$ $(p_1, p_2, p_3,..., p_N)$ï¼Œä¸”å› ä¸ºå¹³é¢ä¸Šçš„ç‚¹æ»¡è¶³ $\mathbf{w}^T\mathbf{x}+b=0$ï¼Œå› æ­¤æœ‰ $\mathbf{w}^T\mathbf{p}+b=0$ã€‚

å‘é‡ $\overrightarrow{PQ} = \mathbf{q} - \mathbf{p}$ï¼Œå…¶ç›¸å¯¹äºå¹³é¢æ³•å‘é‡çš„æŠ•å½±ä¸º $| \overrightarrow{PQ}|\cos \theta$ï¼Œå…¶ä¸­ $\theta$ ä¸º $\overrightarrow{PQ}$ å’Œ $\mathbf{w}$ çš„å¤¹è§’ã€‚è€ƒè™‘å…¶æŠ•å½±çš„å‡ ä½•æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ° $\text{dist}(Q, H) = | \overrightarrow{PQ}|\cos \theta$ã€‚

ä»¤æ³•å‘é‡ $\mathbf{n}\perp H: (w_1, w_2, ..., w_n)$ï¼Œæœ‰



$$
\begin{align}
\overrightarrow{PQ}\cdot \mathbf{n} &= |\overrightarrow{PQ}||\mathbf{n}|\cos \theta\\

|\overrightarrow{PQ}|\cos \theta &= \frac{\mathbf{n}}{|\mathbf{n}|} \cdot \overrightarrow{PQ} \\
\end{align}
$$

å› æ­¤åˆ™æœ‰ï¼š

$$
\begin{align}
\text{dist}(Q, H) &= \frac{\mathbf{n}}{|\mathbf{n}|} \cdot \overrightarrow{PQ} \\
&= \frac{\mathbf{w}}{||\mathbf{w}||} \cdot (\mathbf{q} - \mathbf{p})\\
&= \frac{1}{||\mathbf{w}||} \cdot (\mathbf{w}^T\mathbf{q} - \mathbf{w}^T\mathbf{p})\\
&= \frac{1}{||\mathbf{w}||} \cdot (\mathbf{w}^T\mathbf{q} + b - (\mathbf{w}^T\mathbf{p}+b))\\
\because \quad& \mathbf{w}^T\mathbf{p}+b=0\\
\therefore \quad \text{dist}(Q, H) &= \frac{1}{||\mathbf{w}||} \cdot (\mathbf{w}^T\mathbf{q} + b)\\
&= \frac{\mathbf{w}^T\mathbf{q} + b}{||\mathbf{w}||}

\end{align}
$$


## å®šä¹‰é—´éš”ï¼ˆMarginï¼‰


å®šä¹‰è·ç¦»å…¬å¼

$$
\begin{align}
&\text{dist}(h, \mathbf{x}_i) = \frac{\mid h(\mathbf{x}_i) \mid}{||\mathbf{w}||}\\
s.t. &\quad |\mathbf{w}^T\mathbf{x}_i + b| \geq 0
\end{align}
$$

æˆ‘ä»¬å®šä¹‰é—´éš”

$$
\begin{align}
\gamma_i &= \text{dist}(h, \mathbf{x}_i) \\
&=\frac{\mid h(\mathbf{x}_i) \mid}{||\mathbf{w}||}
\end{align}
$$

æˆ‘ä»¬å®šä¹‰æ‰€æœ‰ç‚¹éƒ½è¢«æ­£ç¡®åˆ†ç±»ï¼Œå³

$$
\begin{equation}
y_i=\left\{
\begin{aligned}
+1 \quad&\text{ if }\mathbf{w}^T\mathbf{x}_i + b>0 \quad \text{åˆ†ç±»æ­£ç¡®}\\
-1 \quad&\text{ if }\mathbf{w}^T\mathbf{x}_i + b<0 \quad \text{åˆ†ç±»æ­£ç¡®}\\
+1 \quad&\text{ if }\mathbf{w}^T\mathbf{x}_i + b\leq0 \quad \text{åˆ†ç±»é”™è¯¯} \\
-1 \quad&\text{ if }\mathbf{w}^T\mathbf{x}_i + b\geq0 \quad \text{åˆ†ç±»é”™è¯¯}
\end{aligned}
\right.
\end{equation}
$$

å³å¦‚æœåˆ†ç±»æ­£ç¡®ï¼Œ$y_i(\mathbf{w}^T\mathbf{x}_i+b)>0$ï¼Œå¦‚æœåˆ†ç±»é”™è¯¯ï¼Œ$y_i(\mathbf{w}^T\mathbf{x}_i +b )\leq0$ã€‚è€ƒè™‘ $y_i \in \{ +1, -1\}$ï¼Œå³ä¹˜ä¸Šå®ƒåªä¼šæ”¹å˜ $\mathbf{w}^T\mathbf{x}_i + b$ çš„æ­£è´Ÿå·è€Œä¸ä¼šæ”¹å˜å…¶ç»å¯¹å€¼ï¼Œå› æ­¤å¦‚æœæ‰€æœ‰ç‚¹éƒ½è¢«æ­£ç¡®åˆ†ç±»ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¾¹è·æ”¹å†™ä¸º

$$
\begin{align}

\gamma_i
=\frac{\mid h(\mathbf{x}_i) \mid}{||\mathbf{w}||}
&=\frac{y_i(\mathbf{w}^T\mathbf{x}_i+b)}{||\mathbf{w}||}
\\
&\Downarrow\\
\gamma_i &=\frac{y_i(\mathbf{w}^T\mathbf{x}_i+b)}{||\mathbf{w}||}\\
s.t. \quad &\forall (\mathbf{x}_i, y_i)\in \mathcal{D}.\quad y_i h(\mathbf{x}_i)>0
\end{align}
$$

ç»è¿‡æ­¤å˜æ¢ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ›´åŠ ç®€æ´çš„è¡¨è¾¾å¼ï¼š

$$
\begin{align}
\gamma_i &=\frac{y_i(\mathbf{w}^T\mathbf{x}_i+b)}{||\mathbf{w}||}\\
s.t. \quad &\forall (\mathbf{x}_i, y_i)\in \mathcal{D}.\quad y_i h(\mathbf{x}_i)>0
\end{align}
$$

## å®šä¹‰åŸé—®é¢˜

æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–æœ€å°çš„é—´éš”ï¼Œå³æˆ‘ä»¬è¦å…ˆæ‰¾åˆ°æœ€å°çš„é—´éš” $\min _n \gamma_n$ï¼Œç„¶åå¯»æ‰¾ä½¿å…¶æœ€å¤§çš„å‚æ•° $\mathbf{w}$ å’Œ $b$ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å®šä¹‰åŸé—®é¢˜ä¸ºï¼š

$$
\begin{align}
& \argmax_{\mathbf{w}, b}\{\min_n \gamma_n\}\\
\text{where}
&\quad \gamma_n = \frac{y_n(\mathbf{w}^T\mathbf{x}_n+b)}{||\mathbf{w}||}\\
s.t. 
&\quad \forall (\mathbf{x}_i, y_i)\in \mathcal{D}.\quad y_i h(\mathbf{x}_i)>0
\end{align}
$$

å³

$$
\begin{align}
& \argmax_{\mathbf{w}, b}\left\{\min_n \frac{y_n(\mathbf{w}^T\mathbf{x}_n+b)}{||\mathbf{w}||}\right\}\\
s.t. 
\quad& \forall (\mathbf{x}_i, y_i)\in \mathcal{D}.\quad y_i h(\mathbf{x}_i)>0
\end{align}
$$

ç”±äºåœ¨æ±‚æœ€å°ç‚¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å›ºå®šäº† $\mathbf{w}$ ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠ $\mathbf{w}$ æå‡ºæ¥ï¼Œå³

$$
\begin{align}
& \argmax_{\mathbf{w}, b}\left\{ \frac{1}{{||\mathbf{w}||}}  \min_n y_n(\mathbf{w}^T\mathbf{x}_i+b) \right\}\\
s.t.
\quad& \forall (\mathbf{x}_i, y_i)\in \mathcal{D}.\quad y_i h(\mathbf{x}_i)>0
\end{align}
$$

è€ƒè™‘å¦‚æœå­˜åœ¨ $\mathbf{w}$ å’Œ $b$ èƒ½æ»¡è¶³è¶…å¹³é¢ã€‚åˆ™è¶…å¹³é¢å¯ä»¥è¢«å®šä¹‰ä¸º

$$
\begin{align}
\mathbf{w}^T\mathbf{x}+b=0
\end{align}
$$

å¦‚æœæˆ‘ä»¬å¯¹ $\mathbf{w}$ å’Œ $b$ è¿›è¡Œç¼©æ”¾ï¼Œå³ $\mathbf{w}\Rightarrow k\mathbf{w}$ï¼Œ$b\Rightarrow kb$ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å¾—åˆ°

$$
\begin{align}
(k\mathbf{w})^T\mathbf{x}+kb&=0\\
k(\mathbf{w}^T\mathbf{x}+b)&=0
\end{align}
$$

å¦‚æœæˆ‘ä»¬è€ƒè™‘æœ€å°è¾¹è·çš„ç‚¹ï¼Œå³ $\min_n y_n(\mathbf{w}^T\mathbf{x}_n+b)$ï¼Œè€ƒè™‘æ€»æ˜¯å­˜åœ¨å¸¸é‡ $k$ ä½¿å¾—$\min_n y_n(k\mathbf{w}^T\mathbf{x}_n+kb) = 1$ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¯¹å¹³é¢è¿›è¡Œä¹˜ $k$ï¼Œå› æ­¤æœ‰ $\min_n y_n(\mathbf{w}^T\mathbf{x}_n+b) = 1$ã€‚è€Œç”±äºæœ€å°åŒ–çš„è¾¹è·è¢«å®šä¹‰ä¸ºäº† $1$ï¼Œå› æ­¤çº¦æŸæ¡ä»¶è¢«æ”¹å†™ä¸º
$$
\begin{align}
s.t.
\quad& \forall (\mathbf{x}_i, y_i)\in \mathcal{D}.\quad y_i h(\mathbf{x}_i)\geq 1
\end{align}
$$


å› æ­¤æˆ‘ä»¬å¯ä»¥æ”¹å†™åŸé—®é¢˜ä¸º

$$
\begin{align}
& \argmax_{\mathbf{w}, b}\left\{ \frac{1}{{||\mathbf{w}||}}  \right\}\\
s.t.
\quad& \forall (\mathbf{x}_i, y_i)\in \mathcal{D}.\quad y_i h(\mathbf{x}_i)\geq 1
\end{align}
$$

è€Œæœ€å¤§åŒ–ä¸€ä¸ªæ•°çš„å€’æ•°ç­‰ä»·äºæœ€å°åŒ–è¿™ä¸ªæ•°çš„å€’æ•°çš„å€’æ•°ï¼Œå³

$$
\begin{align}
& \argmin_{\mathbf{w}, b}\left\{||\mathbf{w}|| \right\}\\
s.t. 
\quad& \forall (\mathbf{x}_i, y_i)\in \mathcal{D}.\quad y_i h(\mathbf{x}_i)\geq 1
\end{align}
$$

è€ƒè™‘æˆ‘ä»¬æœ€å°åŒ–ä¸€ä¸ªç»å¯¹å€¼ï¼Œä¹Ÿå°±åœ¨æœ€å°åŒ–è¿™ä¸ªç»å¯¹å€¼çš„å¹³æ–¹ï¼Œå› æ­¤æœ‰ï¼š

$$
\begin{align}
& \argmin_{\mathbf{w}, b}\left\{||\mathbf{w}||^2\right\}\\
s.t. 
\quad& \forall (\mathbf{x}_i, y_i)\in \mathcal{D}.\quad y_i h(\mathbf{x}_i)\geq 1
\end{align}
$$

ä¸ºäº†æ–¹ä¾¿ä¹‹åçš„æ±‚å¯¼ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæœ€å°åŒ–çš„å¹³æ–¹ä¹˜ä¸Šä¸€ä¸ªæ­£ç³»æ•° $\frac{1}{2}$ï¼Œå³ï¼š

$$
\begin{align}
& \argmin_{\mathbf{w}, b}\left\{\frac{1}{2}|| \mathbf{w} ||^2\right\}\\
s.t. 
\quad& \forall (\mathbf{x}_i, y_i)\in \mathcal{D}.\quad y_i h(\mathbf{x}_i)>0
\end{align}
$$

æˆ‘ä»¬å¯¹ $\mathbf{x}$ è¿›è¡Œéçº¿æ€§å˜æ¢ï¼Œå³ $\mathbf{x}\Rightarrow \phi(\mathbf{x})$ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å¾—åˆ°


$$
\begin{align}

& \argmin_{\mathbf{w}, b}\left\{\frac{1}{2}|| \mathbf{w} ||^2\right\}\\
s.t. \quad& 
\forall (\mathbf{x}_i, y_i)\in \mathcal{D}.\\
&y_i(\mathbf{w}^T\phi(\mathbf{x}_i)+b)\geq1
\end{align}
$$

æˆ‘ä»¬éœ€è¦ä¼˜åŒ–è¿™ä¸ªå‡½æ•°

## æ”¹å†™ä¸ºå¯¹å¶é—®é¢˜

è€ƒè™‘åŸé—®é¢˜

$$
\begin{align}

& \argmin_{\mathbf{w}, b}\left\{\frac{1}{2}|| \mathbf{w} ||^2\right\}\\
s.t. \quad& 
\forall (\mathbf{x}_i, y_i)\in \mathcal{D}.\\
&y_i(\mathbf{w}^T\phi(\mathbf{x}_i)+b)\geq1
\end{align}
$$

ç”±äºçº¦æŸæ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬éš¾ä»¥ç›´æ¥ä¼˜åŒ–ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ”¹å†™é—®é¢˜1ä»¥æ–¹ä¾¿ä¼˜åŒ–ã€‚


æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæƒ©ç½šå‡½æ•° $g(\mathbf{w}, b)$ï¼Œå½“è¿åçº¦æŸæ—¶ï¼Œè¿™ä¸ªæƒ©ç½šä¼šå¾ˆå¤§ï¼Œè€Œå½“æ»¡è¶³çº¦æŸæ—¶ï¼Œè¿™ä¸ªæƒ©ç½šä¼šå¾ˆå°ã€‚å› æ­¤åœ¨ä¼˜åŒ–è¿™ä¸ªæ•´ä½“é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨ä¼˜åŒ–æƒ©ç½šå‡½æ•°ï¼Œå³å°½å¯èƒ½ç¬¦åˆçº¦æŸã€‚å³æˆ‘ä»¬å¯ä»¥å®šä¹‰æŠŠåŸé—®é¢˜é‡æ–°å†™ä¸ºï¼š

$$
\begin{align}
& \argmin_{\mathbf{w}, b}\left\{\frac{1}{2}|| \mathbf{w} ||^2 + g(\mathbf{w}, b)\right\}
\end{align}
$$
å¦‚æœæˆ‘ä»¬èƒ½å°†çº¦æŸè½¬åŒ–ä¸ºä¸Šè¿°çš„ $g$ å‡½æ•°ï¼Œåˆ™æˆ‘ä»¬å°±å¯ä»¥æŠŠåŸé—®é¢˜è½¬åŒ–ä¸ºä¸€ä¸ªæ— çº¦æŸé—®é¢˜ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ„å»ºæƒ©ç½šå‡½æ•° $g$ã€‚

### æƒ©ç½šå‡½æ•°

æˆ‘ä»¬é¦–å…ˆæ”¹å†™çº¦æŸæ¡ä»¶ï¼š

$$
\begin{align}
y_i(\mathbf{w}^T\phi(\mathbf{x}_i)+b)&\geq1\\
&\Downarrow\\
y_i(\mathbf{w}^T\phi(\mathbf{x}_i)+b)-1&\geq0\\
&\Downarrow\\
1-y_i(\mathbf{w}^T\phi(\mathbf{x}_i)+b)&\leq0
\end{align}
$$


æˆ‘ä»¬å¯ä»¥å®šä¹‰æƒ©ç½šå‡½æ•°ä¸º

$$
\begin{align}
& g(\mathbf{w}, b) = \sum_{i=1}^N \alpha_i(1-y_i(\mathbf{w}^T\phi(\mathbf{x}_i)+b))\\
s.t. \quad& \alpha_i \geq 0
\end{align}
$$

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç§° $\alpha_i$ ä¸ºæ‹‰æ ¼æœ—æ—¥ä¹˜å­ã€‚ï¼ˆå› ä¸ºè¿™ä¸ªæ–¹æ³•æœ¬è´¨ä¸Šè¢«ç§°ä¸ºæ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼‰ä¸”å…¶ï¼š

1. å½“ $\mathbf{x}_i$ ä¸æ˜¯æ”¯æŒå‘é‡ï¼Œå³ $\alpha_i = 0$ï¼Œè¿™ä¸ªç‚¹å¯¹äºæœ€ç»ˆçš„åˆ†ç±»æ²¡æœ‰å½±å“
2. å½“ $\mathbf{x}_i$ æ˜¯æ”¯æŒå‘é‡ï¼Œå³ $\alpha_i > 0$ï¼Œè¿™ä¸ªç‚¹å¯¹äºæœ€ç»ˆçš„åˆ†ç±»æœ‰å½±å“

å½“ $\alpha_i > 0$ æ—¶ï¼Œæˆ‘ä»¬ç§° $\mathbf{x}_i$ ä¸ºæ”¯æŒå‘é‡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å°½ç®¡æœ‰å¯èƒ½ $\mathbf{x}_i$ åœ¨è¾¹ç•Œä¸Šï¼Œä½†æ˜¯å…¶ $\alpha_i$ ä»ç„¶å¯èƒ½ä¸º $0$ã€‚

æˆ‘ä»¬å¸Œæœ›ä½¿å¾—æ‰€æœ‰è¿åçº¦æŸçš„ç‚¹çš„æƒ©ç½šå°½å¯èƒ½å¤§ï¼Œå³æˆ‘ä»¬å¸Œæœ›æœ€å¤§åŒ–è¿™äº›æƒ©ç½šï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ”¹å†™æƒ©ç½šå‡½æ•°ä¸ºï¼š

$$
\begin{align}
& g(\mathbf{w}, b) = \max \sum_{i=1}^N \alpha_i(1-y_i(\mathbf{w}^T\phi(\mathbf{x}_i)+b))\\
s.t. \quad& \alpha_i \geq 0
\end{align}
$$

æˆ‘ä»¬å°†æƒ©ç½šå‡½æ•°å¸¦å…¥åŸé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š

$$
\begin{align}
&\argmin_{\mathbf{w}, b}\left\{\frac{1}{2}|| \mathbf{w} ||^2+
\max_\alpha\sum_{n=1}^N\alpha_n(1-y_n(\mathbf{w}^T\phi(\mathbf{x}_n)+b))
\right\}\\
s.t. \quad
&y_n(\mathbf{w}^T\phi(\mathbf{x}_n)+b)\geq1\\
&\alpha_n\geq0
\end{align}
$$

ç”±äºå†…ä¾§ä¼˜åŒ– $\max_\alpha$ å¹¶ä¸ä¼šå½±å“åˆ° $\frac{1}{2}|| \mathbf{w} ||^2$ï¼Œå› æ­¤å¯ä»¥æå‡ºæ¥ï¼Œå³ï¼š
$$
\begin{align}
&\min_{\mathbf{w}, b} \max_\alpha\left\{\frac{1}{2}|| \mathbf{w} ||^2+
\sum_{n=1}^N\alpha_n(1-y_n(\mathbf{w}^T\phi(\mathbf{x}_n)+b))
\right\}\\
s.t. \quad
&y_n(\mathbf{w}^T\phi(\mathbf{x}_n)+b)\geq1\\
&\alpha_n\geq0
\end{align}
æ ¹æ®ä¸€äº›æ•°å­¦æ¨å¯¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„ä¼˜åŒ–é—®é¢˜ä¸ºï¼š
$$

$$
\begin{align}
&\max_\alpha\min_{\mathbf{w}, b} \left\{\frac{1}{2}|| \mathbf{w} ||^2+
\sum_{n=1}^N\alpha_n(1-y_n(\mathbf{w}^T\phi(\mathbf{x}_n)+b))
\right\}\\
s.t. \quad
&y_n(\mathbf{w}^T\phi(\mathbf{x}_n)+b)\geq1\\
&\alpha_n\geq0
\end{align}
$$

> æˆ‘ä»¬å°†çœç•¥ä¸Šä¾§è¿™ä¸€æ­¥çš„æ¨å¯¼ï¼Œç®€å•æ¥è¯´æˆ‘ä»¬å¯ä»¥å°†ä¼˜åŒ–çœ‹æˆä¸¤éƒ¨åˆ†ï¼š
>
> - $\frac{1}{2}|| \mathbf{w} ||^2$â€‹ 
> - $\sum_{n=1}^N\alpha_n(1-y_n(\mathbf{w}^T\phi(\mathbf{x}_n)+b))$
>
> å‰è€…å¯ä»¥è¢«è½»æ˜“è¯æ˜æ˜¯å‡¸çš„ï¼ˆconvexï¼‰ï¼Œå› æ­¤å…¶çš„æå°å€¼ä¸ºå…¨å±€æœ€å°å€¼ã€‚
> è€Œåè€…ä¹Ÿå¯ä»¥è¢«è¯æ˜ä¸ºå‡¹çš„ï¼ˆconcaveï¼‰ã€‚å› æ­¤å…¶çš„æå¤§å€¼ä¸ºå…¨å±€æœ€å¤§å€¼ã€‚
>
> åœ¨æ­¤æƒ…å†µä¸‹çš„ $\max \min$â€‹ æ˜¯å¯ä»¥è¿›è¡Œäº¤æ¢ä¼˜åŒ–çš„ã€‚
>
> TODOï¼š

å³ï¼š
$$
\begin{align}
&\max_\alpha\min_{\mathbf{w}, b}
\mathcal{L}(\alpha, \mathbf{w}, b)=
\left\{\frac{1}{2}|| \mathbf{w} ||^2+
\sum_{n=1}^N\alpha_n(1-y_n(\mathbf{w}^T\phi(\mathbf{x}_n)+b))
\right\}\\
s.t. \quad
&y_n(\mathbf{w}^T\phi(\mathbf{x}_n)+b)\geq1\\
&\alpha_n\geq0
\end{align}
$$

### æ±‚è§£å¯¹å¶é—®é¢˜

æˆ‘ä»¬å¯¹å…¶è¿›è¡Œæ±‚å¯¼ï¼Œå³

$$
\begin{align}
\frac{\partial \mathcal{L}}{\partial \mathbf{w}} &= \mathbf{w} - \sum_{n=1}^N \alpha_n y_n \phi(\mathbf{x}_n) \\
\frac{\partial \mathcal{L}}{\partial b} &= -\sum_{n=1}^N \alpha_n y_n\\
\end{align}
$$

å¦‚æœæŸå¤±æœ€å°ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š

$$
\begin{matrix}
\frac{\partial \mathcal{L}}{\partial \mathbf{w}} = 0&\Rightarrow&\mathbf{w} = \sum_{n=1}^N \alpha_n y_n \phi(\mathbf{x}_n)\\

\\

\frac{\partial \mathcal{L}}{\partial b} = 0 &\Rightarrow& \sum_{n=1}^N \alpha_n y_n = 0
\end{matrix}
$$

å°† $\mathbf{w}$ å’Œ $b$ ä»£å…¥ $\mathcal{L}$ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¼˜åŒ–é—®é¢˜æ”¹å†™ä¸º

$$
\begin{align}
&\argmax_\alpha \mathcal{L}(\alpha)=\sum^N_{n=1}\alpha_n-
\frac{1}{2}\sum^N_{n=1}\sum^N_{m=1}
\alpha_n\alpha_my_ny_m\phi(\mathbf{x}_n)^T\phi(\mathbf{x}_m)\\

s.t.\quad
&\alpha_n\geq 0\\
&\sum^N_{n=1}a_ny_n=0
\end{align}
$$

å®šä¹‰æ ¸å‡½æ•° $\kappa(\mathbf{x}_n, \mathbf{x}_m)=\phi(\mathbf{x}_n)^T\phi(\mathbf{x}_m)$ï¼Œå¯ä»¥æŠŠä¼˜åŒ–é—®é¢˜æ”¹å†™ä¸º

$$
\begin{align}
&\argmax_\alpha \mathcal{L}(\alpha)=\sum^N_{n=1}\alpha_n-
\frac{1}{2}\sum^N_{n=1}\sum^N_{m=1}
\alpha_n\alpha_my_ny_m\kappa(\mathbf{x}_n, \mathbf{x}_m)\\

s.t.\quad
&\alpha_n\geq 0\\
&\sum^N_{n=1}a_ny_n=0\\
\text{where}\quad
&\kappa(\mathbf{x}_n, \mathbf{x}_m)=\phi(\mathbf{x}_n)^T\phi(\mathbf{x}_m)
\end{align}
$$

## é¢„æµ‹

åŸé—®é¢˜çš„é¢„æµ‹æ˜¯å¾ˆç›´è§‰çš„ï¼Œå³ï¼š

$$
\begin{align}
\text{predict}_{prime}(\mathbf{x})&=\text{sign}(h(\mathbf{x}))\\
&=\text{sign}(\mathbf{w}^T\phi(\mathbf{x})+b)\\
&=\text{sign}\left(\sum_{n=1}^N \alpha_n y_n \kappa(\mathbf{x}_n, \mathbf{x})+b\right)
\end{align}
$$

å…¶ä¸­ $\text{sign}$ ä¸ºç¬¦å·å‡½æ•°ï¼Œå³å¦‚æœè¾“å…¥ä¸ºæ­£æ•°ï¼Œåˆ™è¾“å‡ºä¸º $+1$ï¼Œå¦åˆ™è¾“å‡ºä¸º $-1$ã€‚

è€Œå¯¹å¶é—®é¢˜çš„é¢„æµ‹æœ‰æ‰€ä¸åŒã€‚ç”±äºæˆ‘ä»¬æœ‰ $\mathbf{w} = \sum_{n=1}^N \alpha_n y_n \phi(\mathbf{x}_n)$ï¼Œæˆ‘ä»¬å°†å…¶å¸¦å…¥ $h(\mathbf{x})$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š

$$
\begin{align}
h(\mathbf{x})&=\mathbf{w}^T\phi(\mathbf{x})+b\\
&=\left(\sum_{n=1}^N \alpha_n y_n \phi(\mathbf{x}_n)\right)^T\phi(\mathbf{x})+b\\
&=\sum_{n=1}^N \alpha_n y_n \phi(\mathbf{x}_n)^T\phi(\mathbf{x})+b\\
&=\sum_{n=1}^N \alpha_n y_n \kappa(\mathbf{x}_n, \mathbf{x})+b
\end{align}
$$

$$
\begin{align}
\text{predict}_{dual}(\mathbf{x})&=\text{sign}(h(\mathbf{x}))\\
&=\text{sign}\left(\sum_{n=1}^N \alpha_n y_n \kappa(\mathbf{x}_n, \mathbf{x})+b\right)
\end{align}
$$






## è½¯é—´éš” Soft Marginï¼šéçº¿æ€§å¯åˆ†æƒ…å†µ


## SMO ç®—æ³•

## æ ¸å‡½æ•° Kernel Function

